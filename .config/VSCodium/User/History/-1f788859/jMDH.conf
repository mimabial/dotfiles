shell /usr/bin/fish

include hydra.conf
include nerdfont.conf

font_family      FiraCode Nerd Font
# bold_font        Fira Code Bold
italic_font      Maple Mono Italic
bold_italic_font Maple Mono Bold Italic
font_size 14.0
modify_font cell_height 4
# modify_font cell_width 90%
modify_font baseline -1
modify_font strikethrough_position 8px
update_check_interval 0
cursor_trail 20
confirm_os_window_close 0

disable_ligatures cursorshell /usr/bin/fish
inactive_text_alpha 0.8
mouse_hide_wait 3.0
enable_audio_bell no
allow_remote_control yes
listen_on unix:/tmp/kitty-{kitty_pid}.sock
# listen_on unix:/tmp/mykitty
macos_option_as_alt yes
macos_quit_when_last_window_closed yes
scrollback_lines 10000
scrollback_pager_history_size 50

hide_window_decorations   yes
window_border_width 1.5pt
window_padding_width 1

dynamic_background_opacity yes
background_opacity 0.9
inactive-opacity 0.5

enabled_layouts           splits, tall, fat, grid, horizontal, vertical, stack

tab_bar_edge              top
tab_bar_min_tabs          1
tab_bar_style             custom
tab_separator             ""
tab_bar_margin_width      2
tab_bar_margin_height     5 0
active_tab_font_style     bold_italic

tab_title_template        "{fmt.fg._515151}{fmt.bg.default}{fmt.fg._abb2bf}{fmt.bg._515151} {index}:{title} {fmt.fg._515151}{fmt.bg.default} "
active_tab_title_template "{fmt.fg._ffbf70}{fmt.bg.default}{fmt.fg._282c34}{fmt.bg._ffbf70} {index}:{title}{" Z" if layout_name == "stack" else ""} {fmt.fg._ffbf71}{fmt.bg.default} "

kitty_mod ctrl+shift

mouse_map left click ungrabbed no-op

# https://www.gnu.org/software/bash/manual/html_node/ANSI_002dC-Quoting.html
map ctrl+a>ctrl+a send_text all \ca

## clipboard
map alt+v combine : launch --stdin-source=@last_cmd_output --type=clipboard : paste_from_clipboard
map alt+c launch --stdin-source=@last_cmd_output --type=clipboard

map ctrl+h kitten pass_keys.py neighboring_window left   ctrl+h
map ctrl+j kitten pass_keys.py neighboring_window bottom ctrl+j
map ctrl+k kitten pass_keys.py neighboring_window top    ctrl+k
map ctrl+l kitten pass_keys.py neighboring_window right  ctrl+l

map ctrl+a>esc no_op

## scrolling
map ctrl+shift+down scroll_line_down
map ctrl+shift+j scroll_line_down
map ctrl+shift+up scroll_line_up
map ctrl+shift+k scroll_line_up
map alt+shift+k scroll_to_prompt -1
map alt+shift+j scroll_to_prompt 1
map alt+i scroll_page_up
map ctrl+shift+page_down scroll_page_down
map ctrl+shift+home scroll_home
map ctrl+shift+end scroll_end
map ctrl+shift+z scroll_to_prompt -1
map ctrl+shift+x scroll_to_prompt 1
map ctrl+shift+h show_scrollback

## very useful: ctrl+shift+z to scroll to last command output.
## ctrl+shift+x to scroll to next, ctrl+shift+enter brings back last visited in pager
# kitty-scrollback.nvim Kitten alias
# action_alias kitty_scrollback_nvim kitten ~/personal/kitty-scrollback.nvim/python/kitty_scrollback_nvim.py --nvim-args -u ~/.config/nvim/ksb-init.lua
map ctrl+a>enter launch --stdin-source=@screen_scrollback --stdin-add-formatting --type=overlay less +G -R
map ctrl+a>p launch --stdin-source=@last_cmd_output --stdin-add-formatting --type=overlay less +G -R
# map ctrl+a>tab launch --stdin-source=@screen_scrollback --type=overlay ~/bin/fzf-words
map ctrl+a>tab launch --type=overlay sh -c "kitty-tab-text | ~/bin/fzf-words"
# map ctrl+a>p show_last_command_output
# map ctrl+a>k kitty_scrollback_nvim --config ksb_example_get_text_last_cmd_output_plain
# map alt+shift+o kitty_scrollback_nvim --config ksb_example_get_text_first_cmd_output_on_screen
# map alt+shift+p kitty_scrollback_nvim --config ksb_builtin_last_visited_cmd_output
# map ctrl+a>j kitty_scrollback_nvim --jump
# map ctrl+a>/ kitty_scrollback_nvim --search-back
# map alt+shift+o show_first_command_output_on_screen
# map alt+p show_last_visited_command_output

map ctrl+a>ctrl+q send_text all \cq

action_alias open_url_with_hints kitten hints --alphabet zjklh;asdfgyuiopqwertzxcvbnm,.1234567890
map kitty_mod+u open_url_with_hints

# scrollback_pager nvim -u ~/.config/nvim/kitty+page.lua -R -M -
# scrollback_pager nvim -u NORC -R -m -c 'lua require("kitty+page")(INPUT_LINE_NUMBER, CURSOR_LINE, CURSOR_COLUMN)' -
# scrollback_pager nvim -c "lua require('kitty-pager').colorize()"
# scrollback_pager kitty_scrollback_nvim

# map ctrl+a>j kitten kitty_grab/grab.py
# Browse scrollback buffer in nvim
# map kitty_mod+h kitty_scrollback_nvim
# Browse output of the last shell command in nvim
# map kitty_mod+g kitty_scrollback_nvim --config ksb_builtin_last_cmd_output
# Show clicked command output in nvim
mouse_map ctrl+shift+right press ungrabbed combine : mouse_select_command_output : kitty_scrollback_nvim --config ksb_builtin_last_visited_cmd_output

## also default is cmd + k
map ctrl+shift+c clear_terminal scroll active

# map kitty_mod+/>h  kitten config.py
# map kitty_mod+/>k  kitten config.py --keys
# map ctrl+a>shift+/ kitten config.py --actions
# map kitty_mod+/>a  kitten config.py --actions
map kitty_mod+/>/ open_url https://sw.kovidgoyal.net/kitty/
map kitty_mod+/>e  show_kitty_env_vars

map ctrl+a>w launch --type tab --title "kitty-choose-tree" kitty-choose-tree 
# map ctrl+a>shift+w kitten session_renamer.py
# map ctrl+a>shift+i launch --type os-window --allow-remote-control kitty +kitten broadcast --match-tab window_id:$KITTY_WINDOW_ID

## window management

# overlay example
map ctrl+a>f7 launch --title "TODO overlay" --type=overlay screen -d -RR todo nvim $HOME/Documents/.notes/to_do

map ctrl+shift+f8 swap_with_window
map ctrl+shift+f7 focus_visible_window

map ctrl+n launch --location=neighbor
map ctrl+f launch --location=first
map ctrl+shift+h launch --cwd=current --location hsplit
map ctrl+shift+s launch --cwd=current --location vsplit

map ctrl+shift+enter new_window
map ctrl+shift+n new_os_window
map ctrl+shift+w close_window
# map ctrl+shift+alt+w close_window_with_confirmation ignore-shell
map ctrl+a>? detach_window ask
map ctrl+a>! detach_window new-tab
map ctrl+shift+` move_window_to_top
map ctrl+shift+f move_window_forward
map ctrl+shift+b move_window_backward
map ctrl+shift+] next_window
map ctrl+shift+[ previous_window
map ctrl+shift+r start_resizing_window
map ctrl+shift+atl+c kitten rename_os_window.py

map ctrl+shift+1 first_window
map ctrl+shift+2 second_window
map ctrl+shift+3 third_window
map ctrl+shift+4 fourth_window
map ctrl+shift+5 fifth_window
map ctrl+shift+6 sixth_window
map ctrl+shift+7 seventh_window
map ctrl+shift+8 eighth_window
map ctrl+shift+9 ninth_window
map ctrl+shift+0 tenth_window

## tab management
map ctrl+tab next_tab
map ctrl+shift+tab previous_tab
map ctrl+shift+t new_tab
map ctrl+shift+q close_tab
map ctrl+shift+. move_tab_backward
map ctrl+shift+, move_tab_forward
map ctrl+shift+alt+t set_tab_title

map ctrl+1 goto_tab 1
map ctrl+2 goto_tab 2
map ctrl+3 goto_tab 3
map ctrl+4 goto_tab 4
map ctrl+5 goto_tab 5
map ctrl+6 goto_tab 6
map ctrl+7 goto_tab 7
map ctrl+8 goto_tab 8
map ctrl+9 goto_tab 9
map ctrl+0 goto_tab 10

# this is the undo in bash/zsh
map ctrl+shift+- no_op
map ctrl+shift++ no_op

## layout management
map ctrl+alt+n next_layout
map ctrl+alt+p last_used_layout

## select and act on visible text
map ctrl+shift+e open_url_with_hints
map ctrl+shift+p>y kitten hints --type hyperlink

## miscellanious
map ctrl+shift+f2 edit_config_file
map ctrl+shift+f5 load_config_file
map ctrl+shift+f6 debug_config
